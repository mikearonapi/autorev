---
description: "Debug Workflow - Systematic debugging with automatic subagent support. Invoke with @debug-workflow."
globs: []
alwaysApply: false
---

# Debug Workflow

**Automatically invokes `debugger` subagent for systematic investigation.**

## Step 1: INVOKE DEBUGGER SUBAGENT

The `debugger` subagent handles systematic investigation:
- Captures error details and stack traces
- Forms and tests hypotheses
- Finds root causes, not symptoms

## Step 2: REPRODUCE
```
üêõ ISSUE:
- Reported: [What's happening]
- Expected: [What should happen]
- Steps: [How to reproduce]
- Reproducible: [Yes/No/Intermittent]
```

## Step 3: CHECK SOURCE_OF_TRUTH.md
Many bugs are caused by pattern violations. Check:
- Is a Cardinal Rule being violated?
- Is this a known anti-pattern?

### Common AutoRev Bugs

| Symptom | Likely Cause | Fix |
|---------|--------------|-----|
| Data not loading | Using `car_slug` not `car_id` | Use `resolveCarId()` |
| Data not updating | Bypassing Provider | Use Provider hook |
| Wrong colors | Hardcoded hex | Use `var(--color-*)` |
| Touch not working | Target < 44px | Add `h-11 w-11` |
| N+1 performance | Loop queries | Use joins |
| Webhook duplicate | Missing idempotency | Check processed_events |
| "undefined" error | Missing null check | Add `?.` optional chaining |
| Component not rendering | Missing `'use client'` | Add client directive |

## Step 4: ISOLATE
Trace the data flow:
1. Source (database/API)
2. Fetch/query
3. State
4. Render

Find where data goes wrong.

## Step 5: FIX
- Fix root cause, not symptoms
- Minimal change
- Follow existing patterns

## Step 6: VERIFY & REVIEW
```
‚úÖ FIX VERIFIED:
- Root cause: [What was wrong]
- Fix: [What changed]
- Evidence: [Proof it works]
- Regression check: [Related areas still work]
```

**After fix:** Invoke `code-reviewer` subagent to verify fix doesn't introduce new issues.
