---
description: MANDATORY data visualization and UI/UX rules for analytics dashboards. Apply these rules when generating any chart, dashboard, or data display component.
globs:
  - "app/**/*.jsx"
  - "app/**/*.tsx"
  - "components/**/*.jsx"
  - "components/**/*.tsx"
  - "app/admin/**/*.jsx"
  - "app/internal/**/*.jsx"
alwaysApply: false
---

# Data Visualization Rules

> **IMPORTANT:** When generating ANY data visualization code, you MUST follow these rules. Do not deviate without explicit user approval.

---

## Part 1: Chart Selection (What to Use)

### 1.1 Chart Type Decision Tree

| Data Type | USE | DO NOT USE |
|-----------|-----|------------|
| Trend over time (continuous) | Line Chart, Area Chart | Bar Chart, Pie Chart |
| Trend over time (discrete days/weeks) | Vertical Bar Chart | Line Chart (if <7 points), Pie |
| Comparison between categories | **Horizontal** Bar Chart | Vertical Bar Chart |
| Part-to-whole (‚â§4 segments) | Donut Chart | Pie Chart |
| Part-to-whole (>4 segments) | Horizontal Stacked Bar | Pie Chart, Donut |
| Single KPI with goal | Progress Ring / Progress Bar | Any multi-element chart |
| Range data (min/max) | Range Bar (see 1.4) | Standard bar |
| Distribution / Correlation | Scatter Plot (with onboarding) | ‚Äî |

### 1.2 Familiar Forms First
- **Default to Bar and Line charts** ‚Äî universally understood
- **Novel visualizations** (e.g., radial progress rings) must be **central** to the app, not supplementary
- If introducing a unique chart type, provide **explicit onboarding** with animation

### 1.3 Banned Patterns
- ‚ùå **Pie charts** ‚Äî Always use Donut instead
- ‚ùå **3D effects** ‚Äî Flat only
- ‚ùå **Heavy drop shadows on charts**
- ‚ùå **Gridlines by default** ‚Äî Only add if user requests precision reading
- ‚ùå **Separate legends** ‚Äî Use inline/direct labeling instead
- ‚ùå **Vertical bars for comparison** ‚Äî Use horizontal bars

### 1.4 Range Bars (Min/Max Data)
For data with ranges (temperature, blood pressure, price ranges):

```tsx
// Weather-style range bar
<div className="flex items-center gap-2">
  <span className="text-sm w-8">{min}¬∞</span>
  <div className="flex-1 h-1 rounded-full bg-gradient-to-r from-blue-400 via-yellow-400 to-orange-500" />
  <span className="text-sm w-8">{max}¬∞</span>
</div>
```

- Label both ends directly
- Color can encode meaning (blue‚Üíorange for cold‚Üíhot)

---

## Part 2: Visual Hierarchy (The Pyramid)

Structure every dashboard view in this order:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  LEVEL 1: THE PULSE (Top)                                   ‚îÇ
‚îÇ  - 1-3 large KPI cards with trend indicators                ‚îÇ
‚îÇ  - Font: text-4xl to text-6xl, font-bold                    ‚îÇ
‚îÇ  - Include: ‚Üë‚Üì trend icon + % change + sparkline            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  LEVEL 2: THE CONTEXT (Middle)                              ‚îÇ
‚îÇ  - Interactive charts (Line, Bar, Area)                     ‚îÇ
‚îÇ  - Time range selector: [D | W | M | 6M | Y]                ‚îÇ
‚îÇ  - Tappable summary stats below chart                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  LEVEL 3: THE GRAIN (Bottom / Hidden)                       ‚îÇ
‚îÇ  - Data tables, transaction lists                           ‚îÇ
‚îÇ  - Hidden behind "View Details" button or at scroll bottom  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2.1 Progressive Disclosure (Size = Functionality)

| Size | Functionality | Use Case |
|------|--------------|----------|
| **Small (h-16 to h-24)** | Static, no gridlines, no axis labels, no interactivity | Thumbnail previews, sparklines in KPI cards |
| **Medium (h-48 to h-72)** | Full width, axis labels, hover/touch states, time range selector | Main dashboard charts |
| **Large (h-96+)** | Full interactivity, summary stats, overlays, filters | Detail/drill-down views |

**Rule:** Small charts must link to larger versions. Never show a static chart without a path to more detail.

### 2.2 Multi-Scale Data Perspectives
Always design charts to offer insights at THREE scales:

| Scale | What to Show | Example |
|-------|--------------|---------|
| **Macro** | Total, average, overall trend | "Total revenue: $45,230" / Average line overlay |
| **Medium** | Subsets and categories | Weekday vs Weekend, By department, Time of day |
| **Micro** | Individual data points | "Best day: Sunday", "Last transaction: $127" |

```tsx
// Implement with tappable summary rows
const perspectives = [
  { label: 'Total', value: '$45,230', scale: 'macro' },
  { label: 'Daily Average', value: '$1,507', scale: 'macro' },
  { label: 'Weekday Avg', value: '$1,234', scale: 'medium' },
  { label: 'Weekend Avg', value: '$2,100', scale: 'medium' },
  { label: 'Best Day', value: 'Sunday, Dec 15', scale: 'micro' },
  { label: 'Last Transaction', value: '$127', scale: 'micro' },
];
```

---

## Part 3: Color System

### 3.1 AutoRev Brand Colors (MANDATORY)
Use these exact colors for consistency with AutoRev brand:

```typescript
// AutoRev Brand Color System
const BRAND_COLORS = {
  // Backgrounds
  bgPrimary: '#0d1b2a',      // Page backgrounds
  bgSecondary: '#1b263b',    // Cards, elevated surfaces
  bgCard: 'rgba(255, 255, 255, 0.04)',
  
  // Chart-Specific Colors
  chartBaseline: '#3b82f6',   // Blue - Stock/baseline data
  chartModified: '#10b981',   // Teal - Modified/improved data
  chartOutline: 'rgba(255, 255, 255, 0.15)',
  chartGrid: 'rgba(255, 255, 255, 0.08)',
  
  // Accent Colors
  lime: '#d4ff00',            // Emphasis, CTAs
  teal: '#10b981',            // Improvements, gains, selections
  blue: '#3b82f6',            // Baseline, stock values
  gold: '#d4a84b',            // Labels, brand accent
} as const;
```

### 3.2 Semantic Colors (Status)
ONLY use these colors to convey meaning:

```typescript
const STATUS_COLORS = {
  positive: '#10b981',     // Teal - Success, growth, on-track (AutoRev brand)
  warning: '#f59e0b',      // Amber - Caution, approaching limit
  negative: '#ef4444',     // Red - Critical, decline, over-limit
  neutral: '#94a3b8',      // Slate - No status, informational
} as const;
```

### 3.3 Stock vs Modified Comparison Rules
When displaying baseline vs improvement data:

```typescript
// ALWAYS use these exact colors
const COMPARISON_COLORS = {
  stock: '#3b82f6',        // Blue for original/baseline values
  modified: '#10b981',     // Teal for improved/modified values
  gain: {
    text: '#10b981',
    bg: 'rgba(16, 185, 129, 0.15)',
  },
} as const;
```

### 3.4 Category Comparison Rules
- **2 categories:** Blue (#3b82f6) vs Teal (#10b981)
- **3-4 categories:** Use a single-hue progression (blue-400 ‚Üí blue-700)
- **5-6 categories:** Use distinct hues, but group excess into "Other"
- **>6 categories:** STOP. Simplify the visualization.

---

## Part 4: Titles & Labels

### 4.1 Card Title Formula
Every chart card MUST have an interpretive title:

```
BAD:  "Revenue"
BAD:  "Revenue - Last 30 Days"
GOOD: "Revenue is up 12% this month, totaling $45,230"
```

**Formula:** `[Metric] is [direction] [percentage] [timeframe], totaling [value]`

### 4.2 Direct Labeling Rules
- Label the endpoint of line charts with the current value
- Label the highest/lowest bars directly
- Place totals inline with legend items:

```tsx
// DO THIS (inline legend with values)
<div className="flex justify-between">
  <span className="flex items-center gap-2">
    <span className="w-3 h-3 rounded-full bg-blue-500" />
    Team A
  </span>
  <span className="font-semibold">186 pts</span>
</div>

// NOT THIS (separate legend)
<Legend /> // Forces eye-tracking
```

---

## Part 5: Interaction Patterns

### 5.1 Time Range Selector
Always include for time-series charts:

```tsx
<SegmentedControl
  options={['D', 'W', 'M', '6M', 'Y']}
  defaultValue="M"
  onChange={setTimeRange}
/>
```

### 5.2 Hover/Touch States
On interaction, display a vertical rule showing:

```tsx
// Tooltip content structure
<TooltipContent>
  <div className="font-semibold">{formattedValue}</div>  // "$1,452.32"
  <div className="text-slate-500 text-sm">{date}</div>   // "Apr 28, 2022"
</TooltipContent>
```

- Main UI shows rounded values ("$1.5k")
- Tooltip shows precise values ("$1,452.32")

### 5.3 Tappable Summary Statistics
Below interactive charts, add selectable insights:

```tsx
const summaryStats = [
  { label: 'Daily Average', value: 41, type: 'average' },
  { label: 'Weekday Avg', value: 36, type: 'weekday' },
  { label: 'Weekend Avg', value: 53, type: 'weekend' },
  { label: 'Best Day', value: 'Sunday', type: 'highlight' },
];

// When selected: highlight row + add reference line to chart
```

### 5.4 Drill-Down Continuity
When navigating from preview ‚Üí detail view:
- ‚úÖ Preserve chart shape (same type)
- ‚úÖ Preserve visible values
- ‚úÖ Add information (axis labels, interactions)
- ‚ùå Never switch to a completely different chart type
- ‚ùå Never show something different ‚Äî it's disorienting

### 5.5 Reference Line Overlays
Add horizontal reference lines to show aggregate values over bar charts:

```tsx
// Average line overlay
<ReferenceLine
  y={averageValue}
  stroke="#22C55E"
  strokeDasharray="4 4"
  label={{
    value: `${averageValue} avg`,
    position: 'left',
    fill: '#22C55E',
    fontSize: 12,
  }}
/>
```

**When to use:**
- Daily Average line over 30-day bar chart
- Goal/target line for progress tracking
- Comparison lines (e.g., 23-day avg vs 5-day avg in different colors)

### 5.6 Segment Highlighting
When a summary stat row is selected, highlight the corresponding data:

```tsx
// Highlight weekend bars when "Weekend Avg" is selected
<Bar
  dataKey="value"
  fill={({ payload }) => 
    selectedStat === 'weekend' && payload.isWeekend 
      ? '#22C55E'  // Highlighted
      : '#94A3B8'  // Default gray
  }
/>
```

---

## Part 6: Metric Card Anatomy

### 6.1 Standard Metric Card Pattern
Every metric card should follow this structure:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ü´Ä  Resting Heart Rate                                   ‚Ä∫ ‚îÇ
‚îÇ      ‚Üë Icon + Title                            Chevron ‚Üë    ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  On average, your resting heart rate has been               ‚îÇ
‚îÇ  higher for the last 5 days.                                ‚îÇ
‚îÇ  ‚Üë Interpretive description (full sentence)                 ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚óã‚îÄ‚îÄ‚óã‚îÄ‚óã‚îÄ‚îÄ‚óã‚îÄ‚îÄ‚óã‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  67                      ‚îÇ
‚îÇ  62 BPM                              5-day avg              ‚îÇ
‚îÇ  23-day avg                                                 ‚îÇ
‚îÇ  ‚Üë Sparkline with comparison + direct labels                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

```tsx
interface MetricCardProps {
  icon: React.ReactNode;
  title: string;
  interpretation: string;  // Full sentence describing the insight
  currentValue: number;
  currentLabel: string;
  comparisonValue?: number;
  comparisonLabel?: string;
  sparklineData: number[];
  onClick?: () => void;
}

function MetricCard({
  icon,
  title,
  interpretation,
  currentValue,
  currentLabel,
  comparisonValue,
  comparisonLabel,
  sparklineData,
  onClick,
}: MetricCardProps) {
  return (
    <Card className="p-4 cursor-pointer" onClick={onClick}>
      {/* Header */}
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-2 text-red-500">
          {icon}
          <span className="font-medium">{title}</span>
        </div>
        <ChevronRight className="w-5 h-5 text-slate-400" />
      </div>
      
      {/* Interpretation */}
      <p className="mt-3 text-slate-900 font-medium leading-snug">
        {interpretation}
      </p>
      
      {/* Sparkline with labels */}
      <div className="mt-4 relative">
        <Sparkline data={sparklineData} className="h-12" />
        {comparisonValue && (
          <div className="absolute left-0 bottom-0 text-xs text-slate-500">
            {comparisonValue} {comparisonLabel}
          </div>
        )}
        <div className="absolute right-0 bottom-0 text-xs font-semibold text-red-500">
          {currentValue} {currentLabel}
        </div>
      </div>
    </Card>
  );
}
```

### 6.2 Interpretive Description Formulas

| Data Pattern | Formula | Example |
|--------------|---------|---------|
| Trend up | "Your [metric] has been [higher/increasing] for the last [N] days." | "Your resting heart rate has been higher for the last 5 days." |
| Trend down | "Your [metric] has [decreased/dropped] by [X]% this [period]." | "Your average steps have decreased by 12% this week." |
| Stable | "Over the last [N] days, your average [metric] was [value]." | "Over the last 28 days, your average blood oxygen was 98%." |
| Goal progress | "[Metric] for [period] are [up/down] [X]%, totaling [value]." | "Sales for the past 30 days are up 12%, totaling 1,234 pancakes." |
| Comparison | "Your [metric] is [X]% [higher/lower] than [comparison group]." | "Your activity is 23% higher than users your age." |

---

## Part 7: Loading & Empty States

### 7.1 Skeleton Loading
NEVER show blank space while fetching. Use shimmer skeletons:

```tsx
// Skeleton must match the shape of the actual component
<Skeleton className="h-[200px] w-full rounded-xl" />  // Chart area
<Skeleton className="h-8 w-32" />                      // KPI value
<Skeleton className="h-4 w-48" />                      // Title
```

### 7.2 Empty States
If data array is empty, show a zero-state with CTA:

```tsx
if (data.length === 0) {
  return (
    <EmptyState
      icon={<ChartIcon />}
      title="No activity yet"
      description="Start tracking to see your progress here."
      action={<Button>Get Started</Button>}
    />
  );
}
```

### 7.3 Error States
Use "soft" errors‚Äînever crash the screen:

```tsx
if (error) {
  return (
    <Alert variant="subtle">
      <AlertDescription>
        Unable to load data. <Button variant="link">Retry</Button>
      </AlertDescription>
    </Alert>
  );
}
```

---

## Part 8: Code Architecture

### 8.1 Data Transformation in Hooks
Keep transformation logic OUT of components:

```tsx
// hooks/useDashboardData.ts
export function useDashboardData(timeRange: TimeRange) {
  const { data, isLoading, error } = useQuery(...);
  
  const chartData = useMemo(() => {
    if (!data) return [];
    return data.map(row => ({
      date: formatDate(row.created_at),
      value: row.amount,
    }));
  }, [data]);
  
  const summary = useMemo(() => ({
    total: chartData.reduce((sum, d) => sum + d.value, 0),
    average: chartData.length ? total / chartData.length : 0,
    trend: calculateTrend(chartData),
  }), [chartData]);
  
  return { chartData, summary, isLoading, error };
}
```

### 8.2 Memoization Requirements
ALWAYS wrap chart data in `useMemo`:

```tsx
// ‚ùå BAD - causes re-render jitter
const chartData = data.map(d => ({ x: d.date, y: d.value }));

// ‚úÖ GOOD
const chartData = useMemo(
  () => data.map(d => ({ x: d.date, y: d.value })),
  [data]
);
```

### 8.3 Optimistic Updates
For mutations, update UI immediately:

```tsx
const mutation = useMutation({
  mutationFn: updateRecord,
  onMutate: async (newData) => {
    await queryClient.cancelQueries(['dashboard']);
    const previous = queryClient.getQueryData(['dashboard']);
    queryClient.setQueryData(['dashboard'], (old) => ({
      ...old,
      ...newData,
    }));
    return { previous };
  },
  onError: (err, newData, context) => {
    queryClient.setQueryData(['dashboard'], context.previous);
  },
});
```

---

## Part 9: Component Templates

### 9.1 KPI Card Template

```tsx
interface KPICardProps {
  title: string;
  value: number;
  previousValue: number;
  format: 'currency' | 'number' | 'percent';
  sparklineData?: number[];
}

function KPICard({ title, value, previousValue, format, sparklineData }: KPICardProps) {
  const trend = ((value - previousValue) / previousValue) * 100;
  const isPositive = trend >= 0;
  
  return (
    <Card className="p-6">
      <p className="text-sm text-slate-500">{title}</p>
      <div className="flex items-baseline gap-2 mt-1">
        <span className="text-4xl font-bold">
          {formatValue(value, format)}
        </span>
        <span className={cn(
          "text-sm font-medium flex items-center",
          isPositive ? "text-green-500" : "text-red-500"
        )}>
          {isPositive ? <ArrowUp className="w-4 h-4" /> : <ArrowDown className="w-4 h-4" />}
          {Math.abs(trend).toFixed(1)}%
        </span>
      </div>
      {sparklineData && (
        <Sparkline data={sparklineData} className="mt-4 h-12" />
      )}
    </Card>
  );
}
```

### 9.2 Chart Card Template

```tsx
interface ChartCardProps {
  title: string;           // Interpretive title
  subtitle?: string;       // Time range context
  children: React.ReactNode;
  summaryStats?: SummaryStat[];
}

function ChartCard({ title, subtitle, children, summaryStats }: ChartCardProps) {
  const [selectedStat, setSelectedStat] = useState<string | null>(null);
  
  return (
    <Card className="p-6">
      <div className="flex justify-between items-start mb-4">
        <div>
          <h3 className="font-semibold text-lg">{title}</h3>
          {subtitle && <p className="text-sm text-slate-500">{subtitle}</p>}
        </div>
        <TimeRangeSelector />
      </div>
      
      <div className="h-[300px]">
        {children}
      </div>
      
      {summaryStats && (
        <div className="mt-4 space-y-2">
          {summaryStats.map(stat => (
            <SummaryStatRow
              key={stat.label}
              stat={stat}
              isSelected={selectedStat === stat.label}
              onSelect={() => setSelectedStat(stat.label)}
            />
          ))}
        </div>
      )}
    </Card>
  );
}
```

### 9.3 Progress Ring Template
For goal-based progress visualization:

```tsx
interface ProgressRingProps {
  value: number;      // Current value
  goal: number;       // Target value
  color: string;      // Ring color
  size?: number;      // Ring size in pixels
  strokeWidth?: number;
}

function ProgressRing({ value, goal, color, size = 120, strokeWidth = 12 }: ProgressRingProps) {
  const progress = Math.min(value / goal, 1);
  const radius = (size - strokeWidth) / 2;
  const circumference = 2 * Math.PI * radius;
  const strokeDashoffset = circumference * (1 - progress);

  return (
    <svg width={size} height={size} className="transform -rotate-90">
      {/* Background ring */}
      <circle
        cx={size / 2}
        cy={size / 2}
        r={radius}
        fill="none"
        stroke={`${color}20`}
        strokeWidth={strokeWidth}
      />
      {/* Progress ring */}
      <circle
        cx={size / 2}
        cy={size / 2}
        r={radius}
        fill="none"
        stroke={color}
        strokeWidth={strokeWidth}
        strokeDasharray={circumference}
        strokeDashoffset={strokeDashoffset}
        strokeLinecap="round"
      />
    </svg>
  );
}

// Concentric rings composition (3 metrics)
function ConcentricRings({ primary, secondary, tertiary }: RingsData) {
  return (
    <div className="relative w-32 h-32">
      <ProgressRing value={primary.value} goal={primary.goal} color="#FF2D55" size={128} />
      <div className="absolute inset-3">
        <ProgressRing value={secondary.value} goal={secondary.goal} color="#92E82A" size={104} />
      </div>
      <div className="absolute inset-6">
        <ProgressRing value={tertiary.value} goal={tertiary.goal} color="#00C7BE" size={80} />
      </div>
    </div>
  );
}
```

**Requirements for novel visualizations:**
1. Pair with direct labels showing exact progress (e.g., "256/450")
2. Use consistent, memorable colors for each metric
3. Provide onboarding animation on first view
4. Make it the **central** element of the view, not supplementary

---

## Part 10: Pre-Flight Checklist

Before submitting ANY visualization code, verify:

| Check | Question |
|-------|----------|
| ‚òê Hierarchy | Is the most important number the largest element? |
| ‚òê Title | Does the title interpret the data (not just label it)? |
| ‚òê Color | Is color used ONLY for semantic meaning? |
| ‚òê Labels | Are values labeled directly (no separate legend)? |
| ‚òê Loading | Is there a skeleton state while fetching? |
| ‚òê Empty | Is there a zero-state if data is empty? |
| ‚òê Error | Is there a soft error state (not a crash)? |
| ‚òê Memo | Is chart data wrapped in useMemo? |
| ‚òê 5-Second | Can user assess data health in 5 seconds? |
| ‚òê Tufte | What have you REMOVED to make this cleaner? |

---

## Quick Reference: Tailwind Classes

```tsx
// KPI Values
"text-4xl font-bold"           // Primary KPI
"text-2xl font-semibold"       // Secondary KPI
"text-sm text-slate-500"       // Labels

// Status Colors
"text-green-500"               // Positive
"text-amber-500"               // Warning  
"text-red-500"                 // Negative
"text-slate-500"               // Neutral

// Spacing
"p-6"                          // Card padding
"gap-4"                        // Grid gap
"space-y-2"                    // Vertical stack

// Chart Containers
"h-[200px]"                    // Small chart
"h-[300px]"                    // Medium chart
"h-[400px]"                    // Large chart
```

---

## Quick Reference: Recharts Defaults

```tsx
// Always use these defaults for consistency
<AreaChart>
  <defs>
    <linearGradient id="gradient" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stopColor="#3B82F6" stopOpacity={0.3} />
      <stop offset="100%" stopColor="#3B82F6" stopOpacity={0} />
    </linearGradient>
  </defs>
  <Area
    type="monotone"            // Smooth curves
    stroke="#3B82F6"
    fill="url(#gradient)"
    strokeWidth={2}
  />
  <XAxis 
    axisLine={false}           // No axis line
    tickLine={false}           // No tick marks
    tick={{ fontSize: 12, fill: '#64748B' }}
  />
  <YAxis hide />               // Hide Y-axis by default
  <Tooltip content={<CustomTooltip />} />
</AreaChart>
```






